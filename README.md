# ImageMaps
Приложение создано с целью обучения в рамках дисциплины "Технологии разработки приложений для мобильных платформ"

## Начало работы

### Основные требования

1. [Node.js](https://nodejs.org/)

2. [npm](https://www.npmjs.com/) или [Yarn](https://yarnpkg.com/)

3. [Expo CLI](https://docs.expo.dev/get-started/installation/) (`npm install -g expo-cli`)

4. Установите приложение Expo Go на свой телефон или используйте эмулятор.

### Установка

1.  Клонируйте репозиторий
2.  Установите зависимости (`npm install` или `yarn install`)

### Запуск приложения

1.  Запустите приложение Expo (`npx expo start`)
2.  Отсканируйте QR-код с помощью приложения Expo Go на вашем телефоне или запустите приложение на эмуляторе

### Функции и управление

1. Добавление маркера: на главном экране карты нажмите и удерживаете в желаемом месте, новый маркер будет добавлен в указанное место.
2. Просмотр краткой информации маркера: нажмите на нужный маркера, отобразится всплывающее окно с заголовком и описанием.
3. Просмотр детальной информации маркера: нажмите на нужный вам маркер, отобразится всплывающее окно с заголовком и описанием, при нажатии на него откроется окно с детальной информацией о маркере.
4. Удаление маркера: перейдите в детальную информацию о маркере, нажмите кнопку "Удалить маркер".
5. Добавление изображения: перейдите в детальную информацию о маркере, нажмите кнопку "Добавить фото"
6. Сохранение маркера: перейдите в детальную информацию о маркере, добавьте нужные вам данные, нажмите кнопку "Сохранить изменения"

## База данных

Приложение использует локальную базу данных SQLite для хранения информации о маркерах и изображениях. Ниже приведена схема базы данных:

### Таблица markers

Содержит информацию о маркерах.

| Column   | Type  | Constraints | Description                  |
| ----------- | ------- | ----------- | ---------------------------------------------- |
| id    | TEXT  | PRIMARY KEY NOT NULL | Уникальный идентификатор маркера.       |
| latitude | REAL  | NOT NULL  | Широта маркера.                |
| longitude | REAL  | NOT NULL  | Долгота маркера.               |
| title   | TEXT  |       | Заголовок маркера.               |
| description | TEXT | | Описание маркера |
| created_at| DATETIME| DEFAULT CURRENT_TIMESTAMP | Дата и время создания маркера. |

### Таблица marker_images

Содержит информацию об изображениях, связанных с маркерами.

| Column   | Type  | Constraints                | Description                               |
| ----------- | ------- | ----------------------------------------- | ------------------------------------------------------------------------ |
| id    | TEXT  | PRIMARY KEY NOT NULL           | Уникальный идентификатор изображения.                   |
| marker_id | TEXT  | NOT NULL, FOREIGN KEY references markers(id) ON DELETE CASCADE | Идентификатор маркера, к которому привязано изображение. |
| uri    | TEXT  | NOT NULL                 | URI (путь) к изображению.                         |
| created_at| DATETIME| DEFAULT CURRENT_TIMESTAMP        | Дата и время добавления изображения.                    |

## Обработка ошибок

В приложении реализован следующий подход к обработке ошибок:

1. **`try...catch` блоки:** Для асинхронных операций (например, работа с базой данных, получение изображений) используются блоки `try...catch` для отлавливания потенциальных ошибок.
2. **Отображение сообщений об ошибках:** В случае возникновения ошибки пользователю отображается информативное сообщение об ошибке с использованием `Alert.alert()`. Это позволяет пользователю понять, что произошло, и предпринять необходимые действия (например, повторить попытку или проверить подключение к сети).
3. **Логирование ошибок:**  Ошибки логируются в консоль (`console.error()`) для облегчения отладки и выявления проблем.
4. **Обработка ошибок на уровне контекста:**  В `DatabaseContext.tsx` предусмотрено состояние `error` для хранения информации об ошибке, возникшей при работе с базой данных. Это позволяет централизованно обрабатывать ошибки и отображать их в приложении.
